<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kratopia</title>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <style></style>
    <script>
        const regexNAME = new RegExp('[a-zA-Z가-힣0-9-_]', 'g')
        const regexID = new RegExp('[a-zA-Z0-9]', 'g')
        const regexPW = new RegExp('[a-zA-Z0-9!@#$%^&*]', 'g')
        function signUp() {
            name = $('#user_name').val()
            id = $('#user_id').val()
            pw = $('#user_pw').val()
            pwck = $('#user_pwck').val()
            gender = $('input[name=gender]').val()
            jungle_class = $('input[name=class]').val()
            if (regexNAME.test(name) == false) {
                alert('이름은 영문, 한글, -, _ 만 가능합니다.')
            } else if (regexID.test(id) == false) {
                alert('아이디는 영문, 숫자만 가능합니다.')
            } else if (regexPW.test(pw) == false) {
                alert('비밀번호는 영문, 숫자, 특수문자만 가능합니다.')
            } else {
                if (pw == pwck) {
                    $.ajax({
                        type: 'POST',
                        data: { name_give: name, id_give: id, pw_give: pw, gender_give: gender, jungle_class_give: jungle_class },
                        url: '/signup',
                        success: function (res) {
                            if (res['result'] == 'success') {
                                if (res['msg'] == 'nameoverlap') {
                                    alert('이름이 중복됩니다.')
                                    $('#user_name').val('').focus()
                                } else if (res['msg'] == 'None') {
                                    alert('모두 입력해주세요')
                                } else {
                                    alert('가입완료')
                                    window.location.href='/loginpage'
                                }
                            } else {
                                alert('서버오류')
                            }
                        }
                    })
                } else {
                    alert('비밀번호가 다릅니다.')
                    $('#user_pwck').val('').focus()
                }
            }
        }
    </script>
</head>

<body>
    <a href="/">
        <h1>Kratopia</h1>
    </a>
    <div>
        <label for="user_name">name</label>
        <input id="user_name" type="text" autocomplete="off" required>
    </div>
    <div>
        <label for="user_id">ID</label>
        <input id="user_id" type="text" autocomplete="off">
    </div>
    <div>
        <label for="user_pw">PW</label>
        <input id="user_pw" type="password">
    </div>
    <div>
        <label for="user_pwck">PW Check</label>
        <input id="user_pwck" type="password">
    </div>
    <div>
        <label for="man">남자</label>
        <input id="man" name="gender" type="radio" checked value="male">
        <label for="woman">여자</label>
        <input id="woman" name="gender" type="radio" value="female">
    </div>
    <div>
        <label for="red">Red반</label>
        <input id="red" name="class" type="radio" checked value="red">
        <label for="blue">Blue반</label>
        <input id="blue" name="class" type="radio" value="blue">
    </div>
    <div>
        <button onclick="signUp()">가입하기</button>
    </div>
</body>

</html>